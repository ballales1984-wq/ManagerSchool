{% extends "base.html" %}

{% block title %}Dashboard - Registro Scolastico ERP{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h2><i class="bi bi-speedometer2"></i> Dashboard</h2>
        <p class="text-muted">Panoramica generale del sistema</p>
    </div>
</div>

<!-- Statistiche Card -->
<div class="row mb-4">
    <div class="col-md-3 mb-3">
        <div class="card stat-card primary">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="text-muted mb-1">Studenti</h6>
                        <h2 id="stat-studenti">{{ stats.studenti_totali }}</h2>
                    </div>
                    <i class="bi bi-people" style="font-size: 2.5rem; color: #667eea;"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3 mb-3">
        <div class="card stat-card success">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="text-muted mb-1">Insegnanti</h6>
                        <h2 id="stat-insegnanti">{{ stats.insegnanti_totali }}</h2>
                    </div>
                    <i class="bi bi-person-badge" style="font-size: 2.5rem; color: #28a745;"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3 mb-3">
        <div class="card stat-card warning">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="text-muted mb-1">Classi</h6>
                        <h2 id="stat-classi">{{ stats.classi_totali }}</h2>
                    </div>
                    <i class="bi bi-collection" style="font-size: 2.5rem; color: #ffc107;"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3 mb-3">
        <div class="card stat-card danger">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <h6 class="text-muted mb-1">Fragilità</h6>
                        <h2 id="stat-fragilita">{{ "%.1f"|format(stats.fragilita_media) }}</h2>
                    </div>
                    <i class="bi bi-exclamation-triangle" style="font-size: 2.5rem; color: #dc3545;"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Grafici Section -->
<div class="row">
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-graph-up"></i> Performance</h5>
            </div>
            <div class="card-body">
                <canvas id="chart-performance"></canvas>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-4">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-pie-chart"></i> Distribuzione Fragilità</h5>
            </div>
            <div class="card-body">
                <canvas id="chart-fragilita"></canvas>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-lightning"></i> Azioni Rapide</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3 mb-2">
                        <a href="/api/studenti" class="btn btn-outline-primary w-100" id="btn-export-studenti">
                            <i class="bi bi-download"></i> Esporta Studenti (JSON)
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                        <a href="/api/indicatori" class="btn btn-outline-success w-100" id="btn-view-indicators">
                            <i class="bi bi-bar-chart"></i> Indicatori
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                        <a href="/api/report/annuale" class="btn btn-outline-info w-100" id="btn-report">
                            <i class="bi bi-file-text"></i> Report Annuale
                        </a>
                    </div>
                    <div class="col-md-3 mb-2">
                        <a href="/api/analisi/graduatoria" class="btn btn-outline-warning w-100" id="btn-graduatoria">
                            <i class="bi bi-trophy"></i> Graduatorie
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Placeholder per i grafici (puoi integrare Chart.js qui)
    console.log("Dashboard caricata");
</script>
{% endblock %}


